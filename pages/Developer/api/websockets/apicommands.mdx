import { Callout } from 'nextra/components'

# API Commands
Interacting with the API is split into two groups of commands, one way commands and two way commands.

One way commands are simple, and are just a command that you send to tell the overlay to *do* something.

Two way commands are commands that, after completing the requested task, the overlay will send you back a response.
These commands should be handled in your websocket's `OnMessage` event.

## One Way Commands
### ToggleLayoutMode
_Toggles layout mode on or off._

***
### TogglePerformanceStats
_Toggles performance overlay on or off._

***
### Create
_Layout mode toolbar create button, creates an overlay._

***
### Recenter
_Layout mode toolbar recenter button, Recenters the overlay space._

***
### Keyboard
_Layout mode toolbar keyboard button. Summons / dismisses the keyboard._

***
### Layouts
_Layout mode toolbar layouts folder button. Summons / dismisses the layout folder._

***
### Settings
_Layout mode toolbar settings button. Summons / dismisses settings panel._

***
### DeleteAll
_Layout mode toolbar delete button. Deletes all active overlays._

***
### WindowSwitcher
_Layout mode toolbar grid view button._

***
### MediaPlayPause
_Toggles play / pause on media player_

***
### MediaPrevious
_Goes back to previous media._

***
### MediaNext
_Skips to next media._

***
### WindowSettings
_Toggles if the window settings panel is visible._

***
### WindowSelect
_Toggles if the window select panel is visible._

***
### WindowDelete
_Deletes the overlay that has ownership of the window toolbar._

***
### UpdateMediaPlayerInformation
_Updates the media player information with an XSOMediaObject._

***
### SetXSOverlaySystemSetting
_Sets a user settings._

***
### SetActiveOverlaySetting
_Sets a setting on the currently active overlay._

***
### RequestShowTooltip
_Requests to show a tooltip._

***
### PlayDeviceHaptics
_Allows you to play haptic feedback on a device._

```json filename="Haptics Object"
{
    "deviceId": string, // Accepts int or "leftcontroller" / "rightcontroller"
    "duration": int // in microseconds? milliseconds? ask valve idk
}
```

```javascript filename="Example.js"
    Api.Send(Api.Commands.PlayDeviceHaptics, JSON.stringify(new Api.HapticsObject('deviceId', 500)));
```

***
### OpenSteamVRBindings
_Opens the SteamVR Binding Dashboard Page for XSO_

***
### SendNotification
_Sends a notification._
<Callout>
_Websocket notification format is slightly different from UDP notification format. Please make sure your notification object is up to date._
</Callout>

![Notification Markup](../../../../img/notification/NotificationMarkup.png "Notification Markup")
#### Websocket Notification Object
| Property | Type | Description | Default Value |
| --- | --- | --- | --- |
| `type` | `int` | The type of message to send. `1` defines a normal notification. | `1` |
| `index` | `int` | Used for Media Player, changes the icon on the wrist. (depricated, see note below) | `0` |
| `timeout` | `float` | How long the notification will stay on screen for in seconds. | `0.5f` |
| `height` | `float` | Height notification will expand to if it has content other than a title. Default is 175. | `175` |
| `opacity` | `float` | Opacity of the notification, to make it less intrusive. Setting to 0 will set to 1. | `1` |
| `volume` | `float` | Notification sound volume. | `0.7f` |
| `audioPath` | `string` | File path to .ogg audio file. Can be "default", "error", or "warning". Notification will be silent if left empty. | `""` |
| `title` | `string` | Notification title, supports Rich Text Formatting. | `""` |
| `content` | `string` | Notification content, supports Rich Text Formatting, if left empty, notification will be small. | `""` |
| `useBase64Icon` | `bool` | Set to true if using Base64 for the icon image. | `false` |
| `icon` | `string` | Base64 Encoded image, or file path to image. Can also be "default", "error", or "warning". | `""` |
| `sourceApp` | `string` | Somewhere to put your app name for debugging purposes. | `""` |

***
### RequestUpdateCursorCollisionTexture
_Requests that the collision area for the panel be updated. Prevents cursor being visible on transparent parts of UI. May not update instantly._
```cs copy filename="C#"
void foobar()
{
    ulong overlayHandle = 0; // See RequestOverlayIDs command for information about how to get your overlay handle.

    XSOApiObject apiObject = new XSOApiObject(); // See WebsocketAPI / XSOApiObject for more information
    apiObject.sender = "xsoverlay";
    apiObject.target = target;
    apiObject.command = "RequestUpdateCursorCollisionTexture";
    apiObject.jsonData = null;
    apiObject.rawData = overlayHandle;

    ws.Send(JsonSerializer.Serialize(apiObject));
}
```

***
### RequestUpdateOverlayCanvasSize
_Requests that the canvas resolution for the overlay be updated to the requested resolution. May not update instantly._
<Callout>
_You will not need to manually update cursor collision. This command will handle that for you once the texture resolution has been updated._
</Callout>

```cs copy filename="C#"
void foobar()
{
    ulong overlayHandle = 0; // See RequestOverlayIDs command for information about how to get your overlay handle.

    XSOApiObject apiObject = new XSOApiObject(); // See WebsocketAPI / XSOApiObject for more information
    apiObject.sender = "xsoverlay";
    apiObject.target = target;
    apiObject.command = "RequestUpdateOverlayCanvasSize";
    apiObject.jsonData = "{
        "width": int,
        "height": int
    }";
    apiObject.rawData = overlayHandle;

    ws.Send(JsonSerializer.Serialize(apiObject));
}
```

***
### SubscribeToEvents
_Allows the application to subscribe to a set of tags that correspond to events that have return objects. See [Subscribing to Events](websockets#subscribing-to-events)_

***
### Log
_Logs a message to the output log._


## Two Way Commands
***
### RequestDateTime
_Returns the current date and time, including session length, formatted based on User Setting_
```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateDateTime",
    "jsonData": {
        "Date": string,
        "Time": string,
        "CurrentSessionLength": string
    }
}
```

### RequestThemeUpdate
_Returns the current theme colors in hexadecimal_
```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateTheme",
    "jsonData": {
        "HiTone": string,
        "MidTone": string,
        "DarkTone": string,
        "ContrastingTone": string,
        "ErrorTone": string,
        "WarningTone": string,
        "ConfirmTone": string,
        "AccentColor": string,
        "AccentColorBright": string
    }
}
```

***

### RequestSteamAvatar
_Returns the steam avatar of the user_
<Callout>
_This command uses the `rawData` field of `XSOApiObject` rather than the `jsonData` field._
</Callout>

#### Use
```cs
    XSOApiObject.target = "xsoverlay";
    XSOApiObject.command = "RequestSteamAvatar";
    XSOApiObject.rawData = "medium"; // can be large, medium, or small. defaults to medium if left empty

    WebsocketClient.Send(JsonSerializer.Serialize(XSOAbiObject));
```

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateSteamAvatar",
    "jsonData": {},
    "rawData": string // Avatar image .png encoded in base64.
}
```

***
### RequestDeviceInformation 
_Returns a list of devices and information about those devices_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateDeviceInformation",
    "jsonData": {
        [
            {
                "id": int, // Device ID according to SteamVR
                "classification": int,
                "type": int,
                "lastUpdated": string, // ISO-8601 Time 
                "lastBatteryUpdate": string, // ISO-8601 Time 
                "connection": int, // connection status
                "charging": bool, // charging status
                "battery": float, // 0-100 battery life
                "label": string, // shorthand label
                "name": string, // SteamVR device name
                "timeEstimate": string, // estimated time remaining
                "runningBatterySecondsPerPercent": [ // How long in seconds it took for 1% battery to drain. Running list, contains last 5% drain.
                    float,
                    float,
                    float,
                    float,
                    float
                ],
                "runningBatteryIndex": int, // current index for the running list above.
                "fingerprint": string, // SteamVR unique fingerprint for the device. 
                "deviceDidPingLowBattery": bool, // has this device pinged low battery yet
                "friendlyName": string, // friendly name for the device. Not always used. 
                "waitingForFirstRealBatteryUpdate": bool 
            },
            // ... more devices ...
        ]
    }
}
```


***
### RequestLayoutModeState 
_Returns the current open / closed state of Layout Mode_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateLayoutModeState",
    "jsonData": {},
    "rawData": bool // bool representing state of layout mode.
}
```

***
### RequestMediaPlayerUpdate 
_Returns the current media information_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateMediaPlayer",
    "jsonData": {
        "artist": string,
        "title": string,
        "albumTitle": string,
        "albumArt": string, // Base64 string representing album art image.
        "playbackStatus": bool // bool represeting playback state
    }
}
```

***
### RequestGetSettings
_Returns user settings for the overlay_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateSettings",
    "jsonData": {
        "VersionNumber": int,
        "KeyboardSoundpackName": string,
        "KeyboardSoundpackIndex": int,
        "ForceJISKeyboard": bool,
        "KeyboardFormat": int,
        "KeyboardOpacity": float,
        "KeyboardTypingSounds": bool,
        "WristOffsets": {
            "x": float,
            "y": float,
            "z": float
        },
        "WristRotation": {
            "x": float,
            "y": float,
            "z": float
        },
        "WristScale": float,
        "DominantHand": int,
        "Language": int,
        "LanguageURL": string,
        "InputMethod": int,
        "AutomaticMouseControl": bool,
        "DoubleClickDelay": float,
        "DiscordRichPresence": bool,
        "LowBatterySound": bool,
        "LowBatteryWarningPercent": int,
        "HapticsStrength": float,
        "HideTooltips": bool,
        "PointerScale": float,
        "CaptureMethod": int,
        "ShowWindowPreviews": bool,
        "CurvedOverlays": bool,
        "AutoRecenter": bool,
        "InvertScaleGesture": bool,
        "OverlayCurveBias": float,
        "OverlayClipAngle": int,
        "OverlayDefaultScale": float,
        "OverlayDefaultOpacity": float,
        "OverlayDefaultMinFPS": int,
        "OverlayDefaultMaxFPS": int,
        "AimTarget": int,
        "AimAtTarget": bool,
        "GrabSensitivity": float,
        "PushSpeed": float,
        "ScaleSpeed": float,
        "PositionDampening": int,
        "RotationDampening": int,
        "SmartRollAngle": int,
        "AllowWristMovement": bool,
        "HideWristOverlay": bool,
        "WristOpacity": float,
        "WristClipAngle": int,
        "ContinentalTimeFormat": bool,
        "DateFormat": int,
        "AutoMediaDetection": bool,
        "MediaThemeing": bool,
        "AlwaysShowDetailedInformation": bool,
        "DefaultShowBatteryPercentage": bool,
        "BatteryFontScale": int,
        "UseDarkTheme": bool,
        "AdaptiveColor": float,
        "AccentColor": {
            "r": float,
            "g": float,
            "b": float,
            "a": float
        },
        "NotificationScale": float,
        "NotificationOffsets": {
            "x": float,
            "y": float,
            "z": float
        },
        "ForceHigherQualityOverlays": bool,
        "BlockInputToBackgroundApplication": bool,
        "InputBlockingBehavior": int,
        "NightLight": bool,
        "NightLightStartHour": int,
        "NightLightEndHour": int,
        "NightLightStartAMPM": bool,
        "NightLightEndAMPM": bool,
        "NightLightIntensity": float,
        "NightLightSchedule": bool,
        "AllowAdminPermissions": bool,
        "UUID": string,
        "SendAnalytics": bool
    }
}
```

***
### RequestUpdatedLanguageList 
_Returns the list of possible languages_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateLanguageList",
    "jsonData": {
        "LanguageName": string,
        "LanguageName2": string,
        // ... more languages ...
    }
}
```

***
### RequestUpdatedLanguageMap
_Returns the map of strings for the currently selected language_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateLanguageMap",
    "jsonData": {
        // Key value map that XSO uses to translate languages.
        // Please look at translation files for the list of strings.
    }
}
```

***
### RequestAchievementInformation 
_Returns list of achievements with a boolean for unlocked / locked for the user._

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateAchievementStatus",
    "jsonData": {
        "ACHIEVEMENT_NAME": bool,
        "ACHIEVEMENT_NAME_1": bool,
        "ACHIEVEMENT_NAME_2": bool,
    }
}
```

***
### RequestWindowList 
_Returns a list of capturable windows._

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateWindowList",
    "jsonData": {
          "0": {
                "id": int,
                "title": string,
                "icon": string, // base64 icon image
                "windowPreview": string, // base64 preview image. Currently not used.
                "appName": string,
                "isDesktop": bool,
                "isPrimaryDesktop": bool,
                "isUWP": bool,
                "isSystem": bool
            }
            // ... more entries ...
    }
}
```

***
### RequestActiveOverlayInformation
_Requests the current active overlay. This is the overlay that has ownership of the window toolbar_

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateActiveOverlayInformation",
    "jsonData": {
        "0": {
            "id": int,
            "title": string,
            "icon": string, // base64 icon image
            "windowPreview": string, // base64 preview image. Currently not used.
            "appName": string,
            "isDesktop": bool,
            "isPrimaryDesktop": bool,
            "isUWP": bool,
            "isSystem": bool
        }
        // ... more entries ...
    }
}
```

***
### RequestRuntimePerformance
_Requests information about system resource usage, such as CPU, GPU, and Memory._

```javascript filename="Hardware Type / Manufacturer IDs"
const HardwareType = {
    Generic: 0,
    Gpu: 1,
    Cpu: 2,
    Memory: 3
}

const HardwareManufacturer = {
    Nvidia: 0,
    Amd: 1,
    Intel: 2,
    Generic: 3
}
```

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateRuntimePerformance",
    "jsonData": {
        "CPU": {
            "Type": int,
            "Manufacturer": int,
            "Name": string,
            "Temperature": int,
            "Load": int, // Used for device utilization, e.g. GPU / CPU Usage.
            "MemLoad": int, // Used for memory utilization, like VRAM / RAM.
            "MemSize": int
        },
        "GPU": {
            "Type": int,
            "Manufacturer": int,
            "Name": string,
            "Temperature": int,
            "Load": int, // Used for device utilization, e.g. GPU / CPU Usage.
            "MemLoad": int, // Used for memory utilization, like VRAM / RAM.
            "MemSize": int
        },
        "Memory": {
            "Type": int,
            "Manufacturer": int,
            "Name": string,
            "Temperature": int,
            "Load": int, // Used for device utilization, e.g. GPU / CPU Usage.
            "MemLoad": int, // Used for memory utilization, like VRAM / RAM.
            "MemSize": int
        },
        "Frametime": float, // Current time in ms between the previous frame and this frame.
        "Framerate": int, // Current framerate in Frames Per Second
        "MaxFrametime": float, // Maximum frametime based on Headset Refresh Rate in ms e.g. 90hz = 11.1ms
        "MaxFramerate": int // Equal to HMD Refresh Rate
    }
}
```

***
### RequestOverlayIDs
_Sometimes, you might want to change something about the overlay that you are currently rendering on, or about another overlay that exists in the OpenVR scene._
_This command will allow you to do that by getting a map back which allows you to reference the overlay by it's handle with further commands._

_If you are a webapp and have an overlay, to figure out which overlay handle you're rendering on, just access the jsonData property as an array with your URL location._

```javascript filename="Example.js"
Api.Client.Socket.addEventListener('message', function message(data) {
   var decoded = Api.Parse(data);
    switch (decoded.Command) {
        case 'UpdateOverlayIDs':
            console.log(`Current Overlay ID for ${window.location.href} : ${decoded.JsonData[window.location.href]}`);
            break;
    }
});
```

```json filename="Return Object (JSON)"
{
    "target" : "yourappname",
    "command": "UpdateOverlayIDs",
    "jsonData": {
        "overlayPageURL" : ulong,
        "anotherOverlayPageURL" : ulong
        // ... more entries ...
    }
}
```